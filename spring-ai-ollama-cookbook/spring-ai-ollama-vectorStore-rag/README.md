
# 启动chromdb:

chroma run --host 0.0.0.0 --port 8000

![img_1.png](img_1.png)


# RAG测试

## 步骤 1：上传文档

http://localhost:8080/rag/upload

API响应：
```text
Document uploaded and stored successfully: D:\github\spring-ai-cookbook\spring-ai-ollama-cookbook\spring-ai-ollama-vectorStore-rag\src\main\resources\谜语问答游戏.docx

```

## 步骤 2：基于相似度匹配查询

http://localhost:8080/rag/search?query=什么东西会上升但不会下降？

```json
[
  {
    "id": "c0e67a72-a1a3-4535-bdc6-2f038ff2fee2",
    "text": "谜语问答游戏\n\n1、问题： 什么东西会上升但不会下降？ \n答： 你的年龄\n\n2、问题： 每天早晨开始时，您通常会采取什么行动？ \n答： 睁开你的眼睛。\n\n3、问题： 我有钥匙，但打不开锁。 我是什么？ \n答： 钢琴。\n\n4、问题： 当贝克汉姆主罚点球时，他会击中哪里？ \n答： 球\n\n5、问题： 什么东西一分钟一次，一瞬间两次，一千年都没有？ \n答： 字母“M”。\n\n6、问题： 在跑步比赛中，如果你超过了第二个人，你会发现自己处于哪个位置？ \n答： 第二名。\n\n7、问题： 没有翅膀我也能飞翔。 没有眼睛我也能哭。 每当我走的时候，黑暗就跟着我。 我是什么？ \n答： 一朵云。\n\n8、问题： 什么东西无骨却难断？ \n答： 一个鸡蛋\n\n9、问题： 路的左边有一座绿房子，路的右边有一座红房子。 那么，白宫在哪里？ \n答： 在美国华盛顿。\n\n10 、问题： 我有城市，但没有房屋；有森林，但没有树木；有河流，但没有水。 我是什么？ \n答： 一张地图。\n\n11 、问题： 什么是属于你的，但其他人比你使用它更多？ \n答： 你的名字。",
    "media": null,
    "metadata": {
      "distance": 0.22373056,
      "source": "谜语问答游戏.docx"
    },
    "score": 0.7762694358825684
  },
  {
    "id": "2bca3ddb-fcfc-4a0f-8131-32a7fc557b74",
    "text": "Spring AI rocks!! Spring AI rocks!! Spring AI rocks!! Spring AI rocks!! Spring AI rocks!!",
    "media": null,
    "metadata": {
      "distance": 0.42698073,
      "meta1": "meta1"
    },
    "score": 0.57301926612854
  },
  {
    "id": "44da5085-7f88-41ee-8d85-a0cbaf1c69ec",
    "text": "You walk forward facing the past and you turn back toward the future.",
    "media": null,
    "metadata": {
      "distance": 0.54806346,
      "meta2": "meta2"
    },
    "score": 0.4519365429878235
  },
  {
    "id": "b2d87069-da2b-408e-9fcb-902c0c4e5ed1",
    "text": "The World is Big and Salvation Lurks Around the Corner",
    "media": null,
    "metadata": {
      "distance": 0.5719784
    },
    "score": 0.4280216097831726
  }
]
```

## 步骤 3：基于RAG查询

请求：

http://localhost:8080/rag/ask?query=什么东西会上升但不会下降？

响应：

```text
<think>
好的，用户问的是“什么东西会上升但不会下降？”，这个问题看起来像是一个脑筋急转弯。首先，我需要回忆常见的类似谜语或者谜题。通常这类问题的答案可能不是字面意义上的，而是有双关或者隐含的意思。

首先想到的是“年龄”，因为年龄会随着时间推移而增长，但不会减少。不过可能用户想要的答案更具体或者更有趣。另一个可能性是“气球”，但气球会上升然后可能下降，所以不太符合。或者像“价格”在某些情况下会上涨，但通常会有波动，所以也不太对。

再想想，可能涉及到自然现象，比如“太阳的位置”在一天中会上升，但这是相对的，太阳其实是在绕地球转，所以可能不是答案。或者“水位”在涨潮时上升，退潮时下降，所以也不符合。

另一个方向是抽象概念，比如“知识”或“经验”会积累，但不会减少。不过可能用户想要更直接的答案。或者像“等级”比如考试成绩，但也不一定。

突然想到，可能答案是“年龄”，因为年龄只能增加，不会减少。或者“年龄”是常见的答案，比如“年龄会增长，但不会减少”。不过有时候谜语的答案可能更出人意料，比如“你的影子”，当太阳升起时影子变短，但可能不是上升。或者“水中的气泡”，气泡会上升到水面，但最后会破裂，所以可能不是。

再仔细想想，可能答案是“时间”，因为时间总是向前流动，不会倒流。但时间本身不会上升或下降，而是流逝。或者“年龄”更符合，因为年龄是逐渐增加的。

也有可能答案是“年龄”或者“年龄的增长”，所以可能需要确认。不过有时候这类谜题的答案可能更有趣，比如“你的头发”，因为头发会变白，但不会减少。不过不太确定。

或者，答案是“你的身高”，但身高在成长期会上升，之后停止，所以可能不符合。或者“你的体重”在某些情况下会上升，但可能下降，所以也不对。

可能需要再想想，有没有更常见的答案。比如“年龄”是常见的谜语答案，比如“什么东西会增长但不会减少？答案是年龄。”所以可能用户的问题答案就是“年龄”。
</think>

答案是：**年龄**。  
因为年龄会随着时间推移而增长，但不会减少。
```